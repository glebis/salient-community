---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 5);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main class="max-w-3xl mx-auto px-6 py-20">
			<section class="mb-20">
				<h1 class="animate-hero text-4xl md:text-5xl font-serif font-semibold leading-tight mb-6">
					Building what<br />needs to be built.
				</h1>
				<p class="animate-hero-delay text-xl text-ink-light leading-relaxed max-w-2xl">
					A community at the intersection of philosophy, values, and an action-driven approach to technology. For people who are already building — and want what they build to matter.
				</p>
			</section>

			<section class="reveal border-t border-border pt-12 mb-16">
				<h2 class="text-sm font-sans font-medium uppercase tracking-widest text-ink-muted mb-8">What we care about</h2>
				<div class="reveal-stagger grid md:grid-cols-3 gap-8">
					<div>
						<h3 class="text-lg font-serif mb-2">Philosophy</h3>
						<p class="text-ink-light text-base">Grounding technology in deeper questions about what matters and why.</p>
					</div>
					<div>
						<h3 class="text-lg font-serif mb-2">Values</h3>
						<p class="text-ink-light text-base">Making the implicit explicit. Building with intention, not just momentum.</p>
					</div>
					<div>
						<h3 class="text-lg font-serif mb-2">Action</h3>
						<p class="text-ink-light text-base">Using the power of tools for global good. Shipping things that serve people.</p>
					</div>
				</div>
			</section>

			<section class="reveal border-t border-border pt-12 mb-16">
				<h2 class="text-sm font-sans font-medium uppercase tracking-widest text-ink-muted mb-8">Labs</h2>
				<div class="grid md:grid-cols-2 gap-8">
					<a href="https://salience.glebkalinin.com/" class="lab-card block group no-underline border border-border bg-surface-alt/40 rounded-lg p-6">
						<h3 class="text-lg font-serif mb-2 text-ink group-hover:text-accent transition-colors">Salience</h3>
						<p class="text-ink-light text-base">Exploring what stands out. A research space for ideas on attention, meaning, and what deserves to be noticed.</p>
					</a>
					<a href="https://claude.salient.community/" class="lab-card block group no-underline border border-border bg-surface-alt/40 rounded-lg p-6">
						<h3 class="text-lg font-serif mb-2 text-ink group-hover:text-accent transition-colors">Claude Code Lab</h3>
						<p class="text-ink-light text-base">Hands-on experiments with AI-assisted development. Learning to build with Claude Code as a collaborative tool.</p>
					</a>
				</div>
			</section>

			<section class="reveal border-t border-border pt-12 mb-16">
				<h2 class="text-sm font-sans font-medium uppercase tracking-widest text-ink-muted mb-8">Projects</h2>
				<div class="grid md:grid-cols-2 gap-8">
					<a href="https://verity.salient.community/" class="lab-card block group no-underline border border-border bg-surface-alt/40 rounded-lg p-6">
						<h3 class="text-lg font-serif mb-2 text-ink group-hover:text-accent transition-colors">Verity</h3>
						<p class="text-ink-light text-base">Open-source Telegram agent built with Claude Agent SDK. Research, collect knowledge, track habits, process voice — self-hosted, privacy-first.</p>
					</a>
				</div>
			</section>

			<section class="reveal border-t border-border pt-12">
				<h2 class="text-sm font-sans font-medium uppercase tracking-widest text-ink-muted mb-8">Latest writing</h2>
				<ul class="space-y-5">
					{posts.map((post) => (
						<li>
							<a href={`/blog/${post.id}/`} class="group block no-underline">
								<span class="text-lg font-serif text-ink group-hover:text-accent transition-colors">{post.data.title}</span>
								<span class="text-sm text-ink-muted ml-3"><FormattedDate date={post.data.pubDate} /></span>
							</a>
						</li>
					))}
				</ul>
			</section>
		</main>
		<Footer />

		<script>
			const reveals = document.querySelectorAll('.reveal, .reveal-stagger');
			if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
				const observer = new IntersectionObserver(
					(entries) => {
						entries.forEach((e) => {
							if (e.isIntersecting) {
								e.target.classList.add('is-visible');
								observer.unobserve(e.target);
							}
						});
					},
					{ threshold: 0.15 }
				);
				reveals.forEach((el) => observer.observe(el));
			} else {
				reveals.forEach((el) => el.classList.add('is-visible'));
			}
		</script>
	</body>
</html>
